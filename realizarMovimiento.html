<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movimientos</title>
  
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" />
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- jQuery (requerido por DataTables) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <!-- jsPDF para generar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="./styles.css">
  </head>

  <body>
    <div id="mainContainer" class="container">
      <!-- Encabezado con info de usuario y logout -->
      <div class="d-flex justify-content-between align-items-center">
        <div id="userInfo"></div>
        <button id="logoutBtn" class="btn btn-secondary">Cerrar Sesi칩n</button>
      </div>
      <hr />

      <!-- Formulario de Movimiento -->
      <div id="movimientoForm" class="mb-4">
        <h3>Nuevo Movimiento</h3>
        <form id="movementForm">
          <div class="mb-3">
            <label for="movementType" class="form-label">Tipo de Movimiento</label>
            <select id="movementType" class="form-select" required>
              <option value="">Seleccione</option>
              <!-- Entradas -->
              <option value="entrada_compra">Entrada por Compra</option>
              <option value="entrada_devolucion">Entrada por Devoluci칩n</option>
              <!-- Salidas -->
              <option value="salida_venta">Salida por Venta</option>
              <option value="salida_ajuste_negativo">Salida por Ajuste Negativo</option>
              <!-- Traslados -->
              <option value="traslado">Traslado</option>
              <!-- Reajustes -->
              <option value="reajuste">Reajuste Manual</option>
            </select>
          </div>

          <!-- Select de producto -->
          <div class="mb-3">
            <label for="productSelect" class="form-label">Producto</label>
            <select id="productSelect" class="form-select" required>
              <!-- Se cargar치n din치micamente (nombre -> en la UI) -->
            </select>
          </div>

          <!-- Label para mostrar stock actual en la tienda origen -->
          <div id="currentStockLabel"></div>

          <div class="mb-3">
            <label for="quantity" class="form-label">Cantidad</label>
            <input type="number" id="quantity" class="form-control" min="1" required />
          </div>

          <!-- Contenedor para Tienda Origen -->
          <div id="origenContainer" class="mb-3 hidden">
            <label for="origenSelect" class="form-label">Tienda Origen</label>
            <select id="origenSelect" class="form-select"></select>
          </div>

          <!-- Contenedor para Tienda Destino -->
          <div id="destinoContainer" class="mb-3 hidden">
            <label for="destinoSelect" class="form-label">Tienda Destino</label>
            <select id="destinoSelect" class="form-select"></select>
          </div>

          <div class="mb-3">
            <label for="motivo" class="form-label">Motivo (obligatorio para reajustes)</label>
            <input type="text" id="motivo" class="form-control" />
          </div>

          <button type="submit" class="btn btn-success">Registrar Movimiento</button>
        </form>
      </div>

      <!-- Historial de Movimientos -->
      <div id="historyPanel" class="mb-4">
        <h3>Historial de Movimientos</h3>
        <div id="historyContent"></div>
      </div>

      <!-- Traslados Pendientes -->
      <div id="pendingTransfersPanel" class="mb-4">
        <h3>Traslados Pendientes</h3>
        <div id="pendingTransfersContent"></div>
      </div>
    </div>

     <!-- Bootstrap JS Bundle -->
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

     <!-- Script funcional -->
    <script type="module" src="realizarMovimiento.js"></script>
  </body>
</html>
